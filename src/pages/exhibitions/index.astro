---
import Layout from "../../layouts/Layout.astro";

// alle deutschen Exhibitions laden
const entries = await Astro.glob("../../../content/exhibitions/de/*.md");

// Sortierung: neueste zuerst (Jahr absteigend)
// Falls das Datum wichtiger ist, kÃ¶nnte man auch nach frontmatter.date sortieren (falls vorhanden)
const exhibitions = entries
    .map((entry) => ({
        ...entry.frontmatter,
        url: `/exhibitions/${entry.frontmatter.slug}/`,
    }))
    .sort((a, b) => (b.year ?? 0) - (a.year ?? 0));
---

<Layout title="Exhibitions">
    <h1 class="mb-12 text-3xl font-light tracking-wide text-gray-900">
        Exhibitions
    </h1>

    {
        exhibitions.length === 0 ? (
            <p class="text-gray-500">Noch keine Ausstellungen angelegt.</p>
        ) : (
            <div class="grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3">
                {exhibitions.map((exhib) => (
                    <a href={exhib.url} class="group block">
                        <div class="aspect-[4/5] overflow-hidden bg-gray-100 mb-4">
                            {/* Fallback image if cover_image is missing */}
                            {exhib.cover_image ? (
                                <img
                                    src={exhib.cover_image}
                                    alt={exhib.title}
                                    class="h-full w-full object-cover transition-transform duration-500 group-hover:scale-105"
                                />
                            ) : (
                                <div class="flex h-full w-full items-center justify-center text-gray-400">
                                    No Image
                                </div>
                            )}
                        </div>
                        <h2 class="text-lg font-medium text-gray-900 group-hover:text-black">
                            {exhib.title}
                        </h2>
                        <p class="text-sm text-gray-500">
                            {exhib.venue && <span>{exhib.venue}</span>}
                            {exhib.city && <span>, {exhib.city}</span>}
                            {exhib.year && <span> ({exhib.year})</span>}
                        </p>
                    </a>
                ))}
            </div>
        )
    }
</Layout>
